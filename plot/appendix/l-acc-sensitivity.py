# -*- coding: UTF-8 -*-

# For ubuntu env error: findfont: Font family ['Times New Roman'] not found. Falling back to DejaVu Sans.
# ```bash
# sudo apt install msttcorefonts
# rm -rf ~/.cache/matplotlib
# ```
import matplotlib.pyplot as plt
import matplotlib.font_manager as font_manager
from cycler import cycler
import pylab

# input latex symbols in matplotlib
# https://stackoverflow.com/questions/43741928/matplotlib-raw-latex-epsilon-only-yields-varepsilon
plt.rcParams["mathtext.fontset"] = "cm"

Data = {}

lr_01 = [22.59, 26.86, 32.97, 33.78, 36.51, 38.08, 42.05, 43.97, 45.62, 47.27, 47.97, 48.57, 49.32, 49.03, 49.97, 50.57, 50.95, 51.54, 51.38, 51.57, 51.68, 51.65, 51.7, 51.51, 51.46, 51.78, 52.05, 51.89, 51.95, 52.0, 52.03, 52.14, 52.27, 52.19, 51.95, 51.51, 51.62, 51.35, 51.46, 51.22, 51.14, 51.11, 51.16, 51.3, 51.27, 51.38, 51.24, 51.38, 50.97, 51.57, 51.51, 51.54, 51.7, 51.46, 51.27, 51.05, 50.68, 51.05, 51.05, 51.22, 50.76, 50.7, 50.92, 50.92, 50.57, 50.73, 50.46, 50.43, 50.22, 50.46, 50.19, 50.05, 49.57, 49.7, 49.57, 49.38, 49.16, 49.24, 49.27, 48.97, 49.43, 49.35, 48.7, 48.49, 48.76, 48.97, 49.22, 48.97, 49.08, 48.92, 48.57, 48.38, 48.62, 49.05, 48.84, 48.57, 48.41, 48.7, 48.78, 48.86, 48.92, 49.0, 49.05, 48.81, 48.7, 48.7, 48.76, 48.7, 48.76, 48.59, 48.41, 48.38, 48.43, 48.49, 48.59, 48.54, 48.51, 48.46, 48.46, 48.41, 48.38, 48.35, 48.43, 48.43, 48.41, 48.35, 48.35, 48.41, 48.22, 48.3, 48.3, 48.32, 48.41, 48.46, 48.49, 48.43, 48.49, 48.57, 48.57, 48.59, 48.54, 48.54, 48.59, 48.65, 48.68, 48.59, 48.49, 48.51, 48.46, 48.46, 48.46, 48.46, 48.51, 48.54, 48.59, 48.59, 48.59, 48.59, 48.57, 48.54, 48.54, 48.54, 48.54, 48.54, 48.51, 48.54, 48.54, 48.54, 48.57, 48.46, 48.46, 48.46, 48.46, 48.46, 48.43, 48.46, 48.46, 48.43, 48.43, 48.43, 48.41, 48.41, 48.43, 48.41, 48.43, 48.41, 48.41, 48.38, 48.35, 48.35, 48.35, 48.32, 48.3, 48.3, 48.3, 48.32, 48.35, 48.35, 48.32, 48.3]
lr_1 = [16.43, 10.0, 10.0, 7.2, 10.0, 10.27, 10.0, 11.77, 10.07, 16.27, 10.0, 16.63, 9.57, 16.77, 16.2, 10.17, 19.33, 10.87, 18.77, 13.7, 16.0, 15.87, 18.37, 16.77, 19.23, 15.93, 20.17, 16.2, 20.1, 17.03, 19.7, 16.7, 19.8, 15.73, 19.43, 16.07, 19.4, 16.03, 19.5, 16.07, 19.6, 16.57, 19.6, 15.87, 20.57, 15.47, 20.57, 16.0, 20.07, 16.33, 20.13, 17.57, 20.27, 17.23, 20.87, 17.0, 20.5, 16.83, 21.03, 16.23, 20.77, 16.5, 20.7, 17.33, 21.1, 17.3, 20.63, 16.87, 21.17, 17.67, 21.3, 18.3, 21.07, 18.43, 21.27, 18.77, 21.3, 18.53, 22.3, 19.0, 21.83, 19.13, 21.83, 19.17, 21.83, 19.43, 21.53, 19.87, 22.1, 20.47, 21.77, 20.53, 21.63, 20.33, 21.53, 19.6, 21.53, 19.23, 21.73, 21.57, 24.07, 25.67, 26.43, 26.93, 27.0, 27.13, 27.4, 26.97, 26.93, 27.33, 27.3, 27.57, 27.67, 28.03, 28.33, 28.33, 28.5, 28.53, 29.07, 29.13, 29.2, 29.4, 29.47, 29.5, 29.6, 30.13, 30.67, 30.73, 30.73, 30.97, 31.37, 31.1, 30.97, 31.1, 30.8, 30.77, 30.17, 30.37, 30.7, 30.43, 30.2, 30.17, 30.13, 30.27, 30.6, 30.73, 31.13, 31.37, 31.57, 31.57, 31.57, 31.83, 31.77, 31.77, 31.67, 31.6, 31.47, 31.47, 31.5, 31.6, 31.57, 31.7, 31.67, 31.73, 31.87, 31.97, 31.9, 31.83, 31.9, 32.0, 31.97, 32.0, 31.97, 32.0, 32.07, 32.0, 32.03, 31.87, 31.9, 31.77, 31.8, 31.8, 31.83, 31.87, 31.93, 31.9, 31.93, 31.93, 31.93, 31.93, 32.03, 32.03, 31.93, 32.0, 32.1, 32.17, 31.97, 31.93, 31.93, 31.9]
lr_001 = [10.6, 14.2, 17.13, 18.27, 19.57, 21.93, 23.77, 25.0, 27.1, 28.23, 28.77, 29.63, 30.6, 30.63, 30.93, 31.17, 31.4, 31.67, 32.13, 32.63, 32.67, 33.3, 33.77, 34.07, 34.67, 34.83, 35.4, 35.7, 35.93, 36.23, 36.57, 36.67, 37.17, 37.23, 37.57, 37.73, 37.77, 37.93, 38.1, 38.6, 38.87, 39.03, 39.5, 39.7, 40.03, 40.27, 40.4, 40.43, 40.7, 41.17, 41.5, 41.73, 41.8, 41.9, 42.27, 42.3, 42.53, 42.67, 42.9, 43.2, 43.5, 43.63, 43.7, 44.0, 44.07, 44.07, 44.17, 44.63, 44.67, 44.73, 44.63, 44.73, 44.83, 45.03, 45.13, 45.3, 45.43, 45.63, 45.67, 45.9, 46.2, 46.43, 46.57, 46.73, 46.9, 47.1, 47.27, 47.0, 47.2, 47.13, 47.4, 47.4, 47.37, 47.13, 47.2, 47.27, 47.2, 47.1, 47.17, 47.17, 47.23, 47.27, 47.3, 47.27, 47.23, 47.23, 47.2, 47.17, 47.13, 47.13, 47.13, 47.17, 47.2, 47.2, 47.2, 47.2, 47.17, 47.23, 47.23, 47.23, 47.27, 47.3, 47.3, 47.47, 47.47, 47.47, 47.47, 47.47, 47.47, 47.47, 47.47, 47.5, 47.57, 47.53, 47.53, 47.6, 47.6, 47.6, 47.57, 47.57, 47.53, 47.53, 47.57, 47.57, 47.57, 47.6, 47.6, 47.63, 47.8, 47.8, 47.8, 47.8, 47.8, 47.8, 47.8, 47.8, 47.83, 47.83, 47.83, 47.83, 47.83, 47.83, 47.83, 47.83, 47.83, 47.83, 47.83, 47.83, 47.83, 47.83, 47.83, 47.83, 47.83, 47.83, 47.83, 47.83, 47.83, 47.83, 47.83, 47.83, 47.83, 47.83, 47.83, 47.83, 47.83, 47.83, 47.83, 47.83, 47.8, 47.8, 47.8, 47.8, 47.8, 47.8, 47.8, 47.8, 47.8, 47.8, 47.8, 47.8]
Data[0] = [lr_01, lr_1, lr_001]

lr_01 = [55.84, 0.86, 36.35, 20.51, 33.84, 21.14, 61.86, 21.89, 68.3, 24.43, 66.84, 28.7, 67.46, 31.7, 68.68, 36.62, 70.05, 41.97, 72.38, 46.14, 74.32, 49.86, 76.0, 54.51, 77.62, 57.41, 78.43, 60.65, 78.89, 62.14, 79.16, 64.05, 79.86, 66.0, 79.38, 67.05, 79.81, 68.41, 80.0, 69.7, 80.35, 70.76, 80.35, 72.19, 80.92, 74.16, 81.41, 75.32, 81.78, 76.59, 82.62, 77.19, 83.03, 78.62, 82.97, 79.65, 83.16, 80.62, 84.14, 81.68, 84.41, 82.68, 84.76, 83.35, 85.19, 84.0, 85.46, 84.22, 85.65, 84.86, 85.57, 85.41, 85.62, 86.03, 86.3, 86.16, 86.57, 85.84, 86.81, 86.22, 87.3, 86.65, 87.16, 86.65, 87.03, 86.68, 87.08, 86.89, 87.38, 87.19, 87.43, 87.11, 87.51, 87.35, 87.54, 87.68, 87.57, 87.32, 87.76, 87.7, 87.7, 87.81, 88.0, 88.14, 88.11, 88.03, 88.0, 88.16, 88.3, 88.22, 88.14, 88.08, 88.14, 88.14, 88.14, 88.19, 88.27, 88.27, 88.24, 88.3, 88.16, 88.14, 88.0, 88.08, 87.97, 88.19, 88.03, 88.05, 88.05, 88.05, 88.08, 88.08, 87.97, 88.0, 88.03, 88.05, 87.97, 87.97, 87.97, 88.03, 87.97, 88.0, 88.0, 87.95, 88.0, 87.89, 87.97, 87.92, 88.0, 87.97, 87.97, 87.95, 87.95, 87.95, 87.95, 88.03, 88.0, 88.0, 87.97, 88.03, 88.03, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 87.97, 87.97, 87.97, 87.97, 88.05, 87.97, 88.05, 88.03, 87.97, 87.97, 88.05, 88.05, 88.05, 88.03, 88.05, 88.08, 88.05, 88.08, 88.08, 88.11, 88.11, 88.11, 88.11, 88.11, 88.08, 88.08, 88.11, 88.14, 88.14]
lr_1 = [10.0, 45.6, 40.3, 26.9, 23.3, 25.27, 35.1, 27.0, 35.63, 36.1, 36.13, 43.53, 37.97, 10.0, 40.1, 10.0, 42.17, 51.63, 47.0, 58.0, 28.27, 10.0, 10.0, 10.0, 10.0, 65.37, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 37.7, 75.73, 34.73, 72.07, 34.8, 10.0, 35.03, 76.27, 35.6, 76.03, 36.13, 73.23, 34.03, 76.23, 34.87, 78.83, 33.57, 79.23, 32.37, 78.97, 30.7, 78.4, 32.77, 78.47, 31.43, 79.37, 30.57, 79.2, 76.37, 79.97, 77.03, 79.83, 76.03, 79.53, 75.53, 81.7, 75.27, 82.17, 75.6, 82.13, 77.33, 82.43, 76.57, 82.27, 76.8, 82.63, 76.47, 82.27, 76.07, 82.23, 77.57, 83.07, 79.13, 83.4, 78.5, 82.9, 78.5, 83.07, 78.6, 83.5, 78.23, 83.2, 77.9, 82.73, 79.5, 83.77, 79.63, 80.0, 79.2, 79.43, 79.3, 79.7, 79.23, 79.57, 79.23, 79.47, 79.47, 80.13, 79.87, 80.27, 80.37, 80.37, 79.93, 80.17, 80.17, 80.2, 80.3, 80.57, 80.6, 81.1, 80.73, 81.07, 80.57, 80.67, 80.13, 80.5, 80.4, 80.8, 80.5, 80.87, 80.73, 81.1, 80.9, 81.3, 80.97, 81.13, 80.77, 80.87, 80.43, 80.73, 80.47, 80.5, 80.3, 80.9, 81.0, 81.03, 80.97, 81.0, 80.83, 80.9, 80.7, 80.73, 80.63, 80.8, 80.63, 80.67, 80.67, 80.7, 80.6, 80.6, 80.53, 80.63, 80.6, 80.83, 80.7, 81.0, 81.03, 81.33, 81.33, 81.4, 81.23, 81.33, 81.4, 81.53, 81.47, 81.4, 81.37, 81.37, 81.23, 81.3, 81.3, 81.3, 81.23, 81.37, 81.33, 81.5, 81.5, 81.57, 81.57, 81.73, 81.7, 81.7, 81.7, 82.1, 82.03, 82.03, 82.07, 82.03]
lr_001 = [22.07, 38.47, 47.23, 51.33, 51.1, 49.13, 46.63, 42.3, 38.23, 33.67, 31.87, 29.63, 29.97, 29.0, 28.63, 28.0, 28.33, 27.37, 27.5, 26.7, 27.3, 27.6, 28.27, 28.5, 29.3, 29.07, 29.7, 29.57, 30.07, 30.5, 31.37, 31.33, 32.37, 32.73, 33.87, 33.87, 33.87, 33.0, 33.53, 34.57, 36.37, 36.73, 37.77, 38.2, 39.1, 39.1, 39.67, 40.4, 42.2, 43.43, 44.33, 44.47, 45.13, 45.1, 45.63, 45.87, 45.97, 45.97, 47.3, 47.27, 47.8, 48.2, 49.57, 50.27, 51.57, 52.03, 52.63, 52.8, 53.6, 53.57, 54.43, 54.6, 54.8, 54.87, 54.5, 54.57, 55.33, 55.4, 55.57, 55.97, 56.1, 56.63, 56.97, 57.6, 57.5, 57.07, 57.63, 57.77, 58.17, 58.17, 58.67, 58.63, 58.97, 59.57, 59.93, 60.03, 60.53, 60.27, 60.3, 60.3, 60.47, 60.43, 60.4, 60.37, 60.33, 60.4, 60.4, 60.57, 60.63, 60.6, 60.63, 60.5, 60.6, 60.67, 60.7, 60.63, 60.73, 60.77, 60.87, 60.9, 60.87, 60.97, 60.8, 60.97, 60.87, 60.9, 60.97, 60.93, 60.93, 60.93, 61.03, 61.0, 60.97, 60.93, 61.03, 61.13, 61.17, 61.13, 61.13, 61.0, 60.87, 60.93, 61.0, 61.0, 60.9, 60.87, 60.8, 60.77, 60.93, 60.93, 60.93, 60.93, 60.93, 60.93, 60.93, 60.93, 60.93, 60.93, 60.93, 60.93, 60.9, 60.9, 60.87, 60.87, 60.87, 60.83, 60.83, 60.83, 60.87, 60.87, 60.87, 60.83, 60.9, 60.9, 60.9, 60.87, 60.87, 60.87, 60.9, 60.93, 60.9, 60.87, 60.87, 60.9, 60.9, 60.9, 60.9, 60.9, 60.9, 60.9, 60.9, 60.9, 60.9, 60.9, 60.9, 60.87, 60.87, 60.97, 60.9, 60.9]
Data[1] = [lr_01, lr_1, lr_001]

lr_01 = [53.3, 60.51, 55.81, 61.57, 62.35, 62.95, 64.41, 64.11, 65.0, 64.78, 65.68, 65.76, 66.27, 67.14, 67.35, 68.92, 68.92, 70.41, 70.73, 71.57, 71.73, 72.51, 72.59, 73.27, 73.19, 73.73, 73.78, 73.97, 74.16, 74.41, 74.68, 74.68, 74.81, 74.73, 75.05, 75.0, 75.24, 75.11, 75.46, 75.32, 75.62, 75.59, 75.7, 75.86, 75.68, 75.86, 75.81, 75.95, 76.11, 76.11, 76.27, 76.22, 76.59, 76.38, 76.65, 76.46, 76.78, 76.49, 76.84, 76.49, 76.97, 76.62, 77.11, 76.59, 77.24, 76.76, 77.27, 76.76, 77.27, 76.81, 77.32, 76.86, 77.3, 77.0, 77.38, 76.89, 77.46, 77.08, 77.57, 77.11, 77.59, 77.16, 77.65, 77.22, 77.68, 77.32, 77.73, 77.41, 77.7, 77.49, 77.7, 77.41, 77.73, 77.46, 77.7, 77.54, 77.68, 77.62, 77.73, 77.68, 77.73, 77.86, 77.95, 77.92, 77.95, 77.89, 77.95, 78.05, 78.16, 78.24, 78.3, 78.35, 78.27, 78.35, 78.35, 78.38, 78.43, 78.57, 78.59, 78.57, 78.57, 78.57, 78.57, 78.57, 78.62, 78.62, 78.57, 78.57, 78.68, 78.73, 78.89, 78.95, 78.84, 78.78, 78.73, 78.81, 78.78, 78.78, 78.81, 78.92, 78.92, 78.92, 78.92, 78.89, 78.89, 78.86, 78.95, 79.0, 78.97, 78.97, 78.97, 79.0, 79.0, 79.0, 78.97, 78.97, 79.0, 79.0, 78.97, 79.0, 79.05, 79.05, 79.08, 79.08, 79.08, 79.08, 79.08, 79.08, 79.08, 79.08, 79.11, 79.11, 79.11, 79.11, 79.11, 79.11, 79.14, 79.14, 79.14, 79.14, 79.11, 79.11, 79.11, 79.11, 79.16, 79.16, 79.16, 79.16, 79.16, 79.14, 79.14, 79.14, 79.14, 79.14, 79.16, 79.16, 79.16, 79.22, 79.22, 79.22]
lr_1 = [52.0, 4.53, 51.87, 10.13, 53.33, 17.6, 54.33, 22.37, 55.77, 22.63, 56.97, 22.63, 57.33, 23.67, 57.83, 23.83, 58.1, 23.83, 58.27, 24.17, 58.3, 23.9, 58.33, 23.77, 58.33, 23.9, 58.27, 23.97, 58.2, 24.13, 58.47, 24.57, 58.7, 25.17, 58.73, 25.83, 58.67, 26.43, 58.7, 26.43, 58.9, 26.5, 58.83, 26.5, 58.93, 26.5, 58.93, 26.63, 58.83, 26.63, 58.9, 26.63, 58.73, 26.63, 58.73, 26.6, 58.8, 26.6, 58.67, 26.6, 58.67, 26.7, 58.6, 26.7, 58.53, 26.7, 58.37, 26.83, 58.33, 26.87, 58.73, 30.1, 58.5, 30.27, 58.63, 30.27, 59.13, 30.27, 59.13, 30.23, 59.1, 30.13, 58.9, 30.3, 59.17, 30.3, 59.1, 30.3, 58.9, 30.33, 58.93, 30.33, 58.87, 30.23, 58.7, 30.23, 58.93, 30.23, 58.87, 59.03, 59.87, 60.47, 60.2, 60.43, 60.4, 60.43, 60.37, 60.33, 60.2, 60.2, 60.4, 60.4, 60.4, 60.3, 60.37, 60.4, 60.6, 60.53, 60.57, 60.6, 60.63, 60.67, 60.7, 60.6, 60.37, 60.57, 60.67, 60.6, 60.63, 60.7, 60.63, 60.67, 60.57, 60.47, 60.47, 60.4, 60.37, 60.47, 60.5, 60.53, 60.53, 60.6, 60.43, 60.5, 60.5, 60.47, 60.5, 60.37, 60.43, 60.43, 60.67, 60.63, 60.7, 60.77, 60.83, 60.87, 60.97, 60.97, 60.97, 61.03, 61.1, 61.13, 61.17, 61.2, 61.2, 61.3, 61.3, 61.3, 61.4, 61.33, 61.4, 61.4, 61.4, 61.4, 61.4, 61.5, 61.5, 61.53, 61.57, 61.6, 61.57, 61.57, 61.6, 61.63, 61.73, 61.73, 61.73, 61.73, 61.73, 61.73, 61.8, 61.8, 61.8, 61.8, 61.8, 61.8, 61.8, 61.83, 61.83, 61.8]
lr_001 = [12.53, 19.83, 40.73, 48.27, 51.0, 52.5, 53.3, 53.77, 53.93, 54.13, 54.27, 54.43, 54.57, 54.63, 54.73, 54.7, 54.7, 54.77, 54.77, 54.7, 54.57, 54.67, 54.7, 54.8, 55.13, 56.03, 56.87, 57.7, 58.27, 59.07, 59.8, 60.6, 60.97, 61.43, 61.77, 62.1, 62.57, 62.77, 63.03, 63.23, 63.6, 64.03, 64.17, 64.6, 64.8, 65.13, 65.53, 65.77, 66.23, 66.5, 66.83, 67.2, 67.47, 67.7, 68.13, 68.3, 68.6, 68.73, 68.93, 69.1, 69.33, 69.37, 69.5, 69.57, 69.6, 69.67, 69.7, 69.83, 69.87, 69.9, 70.17, 70.13, 70.13, 70.27, 70.4, 70.47, 70.6, 70.8, 70.83, 70.87, 70.9, 71.0, 71.1, 71.13, 71.23, 71.17, 71.2, 71.2, 71.23, 71.13, 71.2, 71.23, 71.27, 71.43, 71.43, 71.43, 71.43, 71.53, 71.6, 71.6, 71.63, 71.73, 71.73, 71.63, 71.63, 71.63, 71.63, 71.67, 71.63, 71.63, 71.63, 71.63, 71.67, 71.67, 71.67, 71.7, 71.7, 71.67, 71.67, 71.7, 71.7, 71.73, 71.73, 71.73, 71.83, 71.83, 71.83, 71.83, 71.87, 71.83, 71.83, 71.83, 71.87, 71.87, 71.83, 71.83, 71.83, 71.87, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9, 71.9]
Data[2] = [lr_01, lr_1, lr_001]


x = range(1, len(Data[0][0]) + 1)
fig, axs = plt.subplots(1, 3)

colors = ("tab:blue",) + plt.get_cmap('Set2').colors
my_cycler = cycler(color=colors)

for i in range(3):
    axs[i].set_prop_cycle(my_cycler)
    axs[i].plot(x, Data[i][0], label="lr=0.01", linewidth=4.5, zorder=10)
    axs[i].plot(x, Data[i][1], label="lr=0.1")
    axs[i].plot(x, Data[i][2], label="lr=0.001")


axs[0].set_title('CNN on CIFAR-10')
axs[1].set_title('CNN on FMNIST')
axs[2].set_title('MLP on FMNIST')
axs[0].set(ylabel='Accuracy (%)')
axs[1].set(xlabel='Training Round')

for ax in axs.reshape(-1):
    ax.grid()

# single legend
handles, labels = axs[0].get_legend_handles_labels()
fig.legend(handles, labels, ncol=5, loc='upper center', bbox_to_anchor=(0.5, 1.01))

# by default is 6.4 x 4.8
fig.set_size_inches(6.4, 2.8)
# plt.tight_layout()
plt.tight_layout(rect=(0, 0, 1, 0.93))
plt.show()
